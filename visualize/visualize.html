<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
        <title>D3 Test</title>
        <script type="text/javascript" src="d3/d3.v3.js"></script>
        <script type="text/javascript" src="js/getData.js"></script>
        <script type="text/javascript" src="js/visualize.js"></script>
        <script type="text/javascript" src="js/helper.js"></script>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.6.2.min.js"></script> 
        <script type="text/javascript" src="js/jquery.tipsy.js"></script>
        <script type="text/javascript" src="js/bestNgrams.js"></script>
        <link href="css/tipsy.css" rel="stylesheet" type="text/css" />
        <style>
            /* For top navi bar*/
            #navlist li
                {
                display: inline;
                list-style-type: none;
                padding-right: 20px;
                }

            /* tell the SVG path to be a thin blue line without any area fill */
            .path1 {
                stroke: steelblue;
                stroke-width: 1;
                fill: none;
            }

            .path2 {
                stroke: red;
                stroke-width: 1;
                fill: none;
            }
            .path3 {
                stroke: green;
                stroke-width: 1;
                fill: none;
            }
            .path4 {
                stroke: brown;
                stroke-width: 1;
                fill: none;
            }
            .path5 {
                stroke: violet;
                stroke-width: 1;
                fill: none;
            }
            
            .axis {
              shape-rendering: crispEdges;
            }

            .x.axis line {
              stroke: lightgrey;
            }

            .x.axis .minor {
              stroke-opacity: .5;
            }

            .x.axis path {
              display: none;
            }

            .y.axis line, .y.axis path {
              fill: none;
              stroke: #000;
            }
        </style>
    </head>
    <body onload="loadForms();">

        <!-- HTML elements -->
        <div id="navcontainer">
            <ul id="navlist">
                <li><a href="#" id="current">viz</a></li>
                <li><a href="#help">help</a></li>
                <li><a href="#idea">idea</a></li>
                <li><a href="#authors">authors</a></li>
            </ul>
        </div>

        <h1 style="display: inline;"> sejm-ngram </h1> version 0.1.0, <a href="changelog.txt"> changelog </a>
        <div style="clear:both">
        
        <div id ="upper">
            <label for="inputNgram">ngram:</label>
            <input id="inputNgram" type="text" size="25" value="w">
            
            <label for="inputDateFrom">date from:</label>
            <input id="inputDateFrom" type="text" size="15" value="2011-11-8">
            
            <label for="inputDateTo">date to:</label>
            <input id="inputDateTo" type="text" size="15" value="2011-12-1">

            <input type="button" size="25" value="Generate Viz!" onClick="buttonGenVizPressed();">  

            <div>
                <div style="float:left">
                  <label for="selectField1Grams">popular 1grams:</label> <br/>
                  <select id = "selectField1Grams" onChange="ngramSelected(this.options[this.value].text);">
                  </select>
                </div>

                <div style="float:left">
                  <label for="selectField2Grams">popular 3grams:</label> <br/>
                  <select id = "selectField2Grams" onChange="ngramSelected(this.options[this.value].text);">
                  </select>
                </div>

                <div style="float:left">
                  <label for="selectField3Grams">popular 3grams:</label> <br/>
                  <select id = "selectField3Grams" onChange="ngramSelected(this.options[this.value].text);">
                  </select>
                </div>
            </div>

        </div>

        <!-- <div id="graph" class="aGraph" style="position:absolute;top:0px;left:0; float:left;"></div> -->
        <div id="graph" class="aGraph"></div> 

        <h4> viz debug options:</h4>

        <!-- Some more controls for bottom line -->
        <div style="float:left;" >
            <label for="inputChkBoxDrawLines">draw lines: </label>
            <input type="checkbox" id= "inputChkBoxDrawLines" size="25" value="!" onClick="checkBoxDrawLinesPressed(this);"/>  
        </div>

        <div style=" margin-left:200px">
            <label for="inputChkBoxIncludeZeros">include 0-s: (needs to generate viz again)</label>
            <input type="checkbox" id= "inputChkBoxIncludeZeros" size="25" value="!" onClick="console.log('chbox presed! ' + this.checked );"/>  
        </div>

        <div style="float:left; " >
            <label for="inputXRes">x-res: </label>
            <input id="inputXRes" type="text" size="15" value="12"/>  
        </div>

        <div style="float:left; margin-left:35px">
            <label for="inputChkUseAllDataPoints">use all datapoints (needs to regenerate viz again): </label>
            <input type="checkbox" id= "inputChkUseAllDataPoints" size="25" value="!" onClick="console.log('chbox pressed');" checked />  
        </div>
        <div style="clear:both">

        <h1> help </h1>
        <a name="help"></a>
        <p> It's very easy. Simply type some ngram into "ngram" text field, type dates (from / to) in the "yyyy-mm-dd"
            format and press "Generate Viz!" button. Since we're working on it we have provided some debug options on
            the bottom of chart. 
        </p>

              <ul id="debugOptionsList">
                <li>draw lines - simply connects the datapoints for each party. does not require generating the chart again.</a></li>
                <li>include 0-s - showing the datapoints of 0 value for dates / periods (see "use all data points") that don't have any ngrams. requires generating the chart again.</a></li>
                <li>x-res - when "use all datapoints" is not selected the time scope between "startDate" and "stopDate" is divided into "x-res" number of boxes; the ngrams with dates fitting the single box's (sic!) scope are summarized</a></li>
                <li>use all datapoints - when selected, the ngrams are summarized per single day, otherwise the whole time scope is divided into a number of boxes specified by "x-res" value. </a></li>
            </ul>

        <h1> idea </h1>
        <a name="idea"></a>
        <p> 
            The sejm-ngram provides a visualization of selected <a href="http://en.wikipedia.org/wiki/N-gram"> ngrams </a> occurences within the speeches of Polish Parliament members. 
            The project is meant to become an useful tool for a simple, quantitative analysis of what is happening behind the doors of Polish Parliament. Initially we would like to provide simple, ngram analysis, possibly with extending it by sentiment analysis. Sejm-ngram, by being based on open data with public speeches of Polish deputies (provided by http://sejmometr.pl/) aspires to be an example of data journalism - a domain that we believe is emerging right now.


            <h4> current features / matters </h4>            
            <ul id="currentFeaturesList">
                <li>Works with 1-, 2- and 3grams (you need more!)</a></li>
                <li>there's not much data yet - the speeches used as sources took place from 2011-11-08 to 2013-03-22</li>
                <li>is not super-fast</li>
            </ul>

            <h4> to be done! </h4>            
            <ul id="todoFeaturesList">
                <li>use some no-sql db for faster working</li>
            </ul>

        </p>

        <h1> authors </h1>
        <a name="authors"></a>
         <ul id="authorsList">
                <li>Tomasz Guz</li>
                <li>Tomasz Kuśmierczyk</li>
                <li>Krzysztof Siejkowski</li>
                <li>Michał Siemiończyk</li>
            </ul>




        <!-- JavaScript - functions for manipulating the GUI (could be in sepearated file though) -->
        <script>

            //here we contain functions maintaining GUI
            /* After the button "Generate Viz!" was pressed.*/
            function buttonGenVizPressed(){
                console.log("button Pressed");
                var ngram = document.getElementById("inputNgram").value;
                var dateFrom = document.getElementById("inputDateFrom").value;
                var dateTo = document.getElementById("inputDateTo").value;  
                var xRes = document.getElementById("inputXRes").value;  
                startVisualization(ngram, dateFrom, dateTo, xRes);
            }

            /* Handle "Draw Lines" CheckBox */
            function checkBoxDrawLinesPressed(chckBox){
                for(partylines in dataSets){
                    document.getElementById("idPathPoint" + partylines).style.visibility =
                        chckBox.checked ? "visible" : "hidden";
                }
            }

            /* Puts chosen ngram to textField. Invoked after selecting ngram from 
                any of the select fields
            */
            function ngramSelected(ngramWord){
                document.getElementById("inputNgram").value = ngramWord;
            }

            /* Fills the form with necessary data*/
            function loadForms(){
                // fill 1grams select form
                var field1Grams = document.getElementById("selectField1Grams");
                for(i = 0, x = oneGrams.length;  i < x ; i++){
                    field1Grams.options[field1Grams.options.length] = new Option(oneGrams[i], i);
                }

                // fill 2grams select form
                var field2Grams = document.getElementById("selectField2Grams");
                for(i = 0, x = twoGrams.length;  i < x ; i++){
                    field2Grams.options[field2Grams.options.length] = new Option(twoGrams[i], i);
                }

                // fill 3grams select form
                var field3Grams = document.getElementById("selectField3Grams");
                for(i = 0, x = threeGrams.length;  i < x ; i++){
                    field3Grams.options[field3Grams.options.length] = new Option(threeGrams[i], i);
                }
            }

        </script>

        <!-- 
            JavaScript - Main loop of the file - vizualises default ngrams 
        -->
        <script>

            // main loop of our site
            var ngram = document.getElementById("inputNgram").value;
            var dateFrom = document.getElementById("inputDateFrom").value;
            var dateTo = document.getElementById("inputDateTo").value;
            var xRes = document.getElementById("inputXRes").value; 
            startVisualization(ngram, dateFrom, dateTo, xRes);

        </script>

    </body>
</html>    